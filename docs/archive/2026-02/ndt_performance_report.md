# NDT 성능 평가 및 실험 결과 보고서

## 목차
1. [개요](#개요)
2. [실험 환경 및 구성](#실험-환경-및-구성)
3. [벤치마크 결과](#벤치마크-결과)
    3.1 [정량적 지표 비교](#정량적-지표-비교)
    3.2 [요소별 세부 분석](#요소별-세부-분석)
4. [NDT 성능 분석](#ndt-성능-분석)
    4.1 [연산 속도와 정확도의 트레이드오프](#연산-속도와-정확도의-트레이드오프)
    4.2 [회전 오차 발생 원인 분석](#회전-오차-발생-원인-분석)
5. [결론](#결론)

---

## 개요
본 보고서는 `gtsam_points` 프레임워크 내에 구현된 NDT(Normal Distributions Transform) Factor의 성능을 검증하기 위해 수행된 벤치마크 결과를 기술한다. 다양한 LiDAR Registration 알고리즘들과의 비교를 통해 NDT의 연산 효율성 및 추정 정확도를 다각도로 분석한다.

## 실험 환경 및 구성
- **Dataset**: `data/pcd` 디렉토리에 포함된 7개의 연속된 PCD 프레임
- **Noise Configuration**: 0.1 scale의 노이즈 추가
- **Threads**: 4 threads (OpenMP 병렬 처리 적용)
- **Comparison Factors**:
    - Point-to-Point ICP
    - Point-to-Plane ICP
    - GICP (Generalized-ICP)
    - VGICP (Voxelized GICP)
    - LOAM (LIO-SAM 스타일 Edge/Planar 특징점 기반)
    - **NDT (DIRECT7 search mode)**

## 벤치마크 결과

### 정량적 지표 비교
각 Factor별 평균 및 최대 오차, 연산 시간을 정리한 표는 다음과 같다.

| Factor | Mean Trans Error (m) | Mean Rot Error (deg) | Max Trans Error (m) | Max Rot Error (deg) | Time (ms) | Iterations |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: |
| **Point-to-Point** | 0.0954 | 0.4876 | 0.2192 | 0.9084 | 1033.3 | 31 |
| **Point-to-Plane** | **0.0615** | **0.4487** | **0.1257** | **0.9299** | 905.8 | 25 |
| **GICP** | 0.0841 | 0.5515 | 0.1651 | 1.1028 | 1423.3 | 31 |
| **VGICP** | 0.2164 | 1.0382 | 1.0807 | 3.4646 | 1638.2 | 67 |
| **LOAM** | 0.3117 | 1.1575 | 0.9543 | 2.6218 | 148.6 | 101 |
| **NDT** | 0.0772 | 4.5772 | 0.1387 | 7.0066 | **72.6** | 11 |

### 요솔별 세부 분석
1. **Point-to-Plane**: 본 데이터셋에서 가장 높은 정확도를 보여주었으며, 수렴 속도(25 iterations) 또한 안정적이다.
2. **VGICP**: Frame 3에서 급격한 오차(T-Err: 1.08m, R-Err: 3.46°)가 발생하여 전체적인 평균치가 상승하였다. 이는 특정 환경에서의 수렴 불안정성을 시사한다.
3. **LOAM**: 특징점 기반 방식으로 연산 속도는 빠르나(148.6ms), 프레임 간의 오차가 기하학적 전체 매칭 방식에 비해 다소 높게 나타났다.
4. **NDT**: 연산 시간 면에서 압도적인 성능(72.6ms)을 보여주었으나, 회전 오차가 타 알고리즘 대비 높게 측정되었다.

## NDT 성능 분석

### 연산 속도와 정확도의 트레이드오프
NDT는 벤치마크 대상 중 가장 빠른 **72.6ms**의 총 연산 시간을 기록하였다. 이는 타 알고리즘 대비 최소 2배(LOAM 대비)에서 최대 22배(VGICP 대비) 빠른 속도이다. 
- **장점**: 실시간성이 극도로 요구되는 환경에서 매우 유리하다.
- **단점**: 위치 추정 오차(Mean Trans Error)는 0.077m로 우수하나, 회전 오차(Mean Rot Error)가 4.57°로 비교적 높게 나타난다.

### 회전 오차 발생 원인 분석
이번 실험에서 NDT에 적용된 `DIRECT7` 검색 모드는 정확도보다는 연산 효율성에 최적화된 설정이다. 
1. **Grid Voxelization**: NDT는 공간을 Voxel로 나누어 정규 분포를 계산하므로, Voxel 크기 및 분포 모델링 방식에 따라 회전 변화에 대한 민감도가 달라질 수 있다.
2. **Search Mode**: `DIRECT7` 방식은 주변 Voxel 탐색 범위를 제한하여 속도를 높이지만, 회전 변화가 큰 초기치(Initial Guess)가 주어졌을 때 정확한 해를 찾는 능력이 저하될 수 있다.

## 결론
`gtsam_points` 프레임워크에 통합된 NDT Factor는 매우 뛰어난 연산 효율성을 입증하였다. 비록 현재 설정(`DIRECT7`)에서는 회전 정확도가 다소 낮게 나타났으나, 이는 고속 주행 환경이나 제한된 컴퓨팅 자원 환경에서 충분히 수용 가능한 수준이다. 향후 높은 정확도가 요구되는 상황에서는 Search Mode를 조정하거나 Voxel resolution을 최적화함으로써 성능을 개선할 수 있을 것으로 기대된다.
